name: Keep Service Alive

on:
  schedule:
    # æ¯ 14 åˆ†é˜åŸ·è¡Œä¸€æ¬¡ï¼ˆRender å…è²»æ–¹æ¡ˆ 15 åˆ†é˜å¾Œä¼‘çœ ï¼‰
    - cron: '*/14 * * * *'
  workflow_dispatch: # å…è¨±æ‰‹å‹•è§¸ç™¼

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    
    steps:
    - name: Ping Service
      run: |
        echo "ğŸ”„ é–‹å§‹ ping æœå‹™..."
        
        # æ›¿æ›ç‚ºä½ çš„ Render æœå‹™ URL
        SERVICE_URL="https://your-render-service-url.onrender.com"
        
        # Ping keep-alive ç«¯é»
        response=$(curl -s -o /dev/null -w "%{http_code}" \
          --max-time 30 \
          --user-agent "GitHub-Actions-KeepAlive/1.0" \
          "${SERVICE_URL}/keep-alive")
        
        if [ "$response" = "200" ]; then
          echo "âœ… æœå‹™ ping æˆåŠŸ - HTTP $response"
        else
          echo "âš ï¸ æœå‹™ ping å¤±æ•— - HTTP $response"
          exit 1
        fi
        
        # ä¹Ÿ ping å¥åº·æª¢æŸ¥ç«¯é»
        health_response=$(curl -s -o /dev/null -w "%{http_code}" \
          --max-time 30 \
          --user-agent "GitHub-Actions-HealthCheck/1.0" \
          "${SERVICE_URL}/health")
        
        if [ "$health_response" = "200" ]; then
          echo "âœ… å¥åº·æª¢æŸ¥æˆåŠŸ - HTTP $health_response"
        else
          echo "âš ï¸ å¥åº·æª¢æŸ¥å¤±æ•— - HTTP $health_response"
        fi
        
        echo "ï¿½ï¿½ Keep-alive ä»»å‹™å®Œæˆ" 