#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
è©é¨™æ¡ˆä¾‹åˆ†äº«æ¸¬è©¦æ¨¡çµ„
æ¸¬è©¦è©é¨™è©±è¡“å’Œæ¡ˆä¾‹çš„å…§å®¹
"""

import sys
import os
import json

# æ·»åŠ ç•¶å‰ç›®éŒ„åˆ°Pythonè·¯å¾‘
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from fraud_knowledge import load_fraud_tactics, get_anti_fraud_tips

def test_fraud_cases_content():
    """æ¸¬è©¦è©é¨™æ¡ˆä¾‹çš„å…§å®¹è±å¯Œåº¦"""
    print("=" * 60)
    print("ğŸ“‹ è©é¨™æ¡ˆä¾‹å…§å®¹æ¸¬è©¦")
    print("=" * 60)
    
    # è¼‰å…¥è©é¨™è©±è¡“è³‡æ–™
    fraud_tactics = load_fraud_tactics()
    
    if not fraud_tactics:
        print("âŒ ç„¡æ³•è¼‰å…¥è©é¨™è©±è¡“è³‡æ–™")
        return False
    
    print(f"âœ… æˆåŠŸè¼‰å…¥ {len(fraud_tactics)} ç¨®è©é¨™é¡å‹")
    
    # é¸å‡ºä¸‰å€‹ä»£è¡¨æ€§çš„è©é¨™æ¡ˆä¾‹é€²è¡Œè©³ç´°åˆ†äº«
    featured_cases = [
        "å‡äº¤å‹æŠ•è³‡è©é¨™",
        "ç¶²è·¯è³¼ç‰©è©é¨™", 
        "å‡æª¢è­¦è©é¨™"
    ]
    
    results = []
    
    for i, case_type in enumerate(featured_cases, 1):
        print(f"\n" + "="*50)
        print(f"ğŸ“– è©é¨™æ¡ˆä¾‹åˆ†äº« {i}: {case_type}")
        print("="*50)
        
        if case_type in fraud_tactics:
            description = fraud_tactics[case_type]
            print(f"ğŸ“ è©é¨™æ‰‹æ³•èªªæ˜ï¼š\n{description}")
            
            # ç”Ÿæˆè©³ç´°çš„æ¡ˆä¾‹åˆ†äº«
            case_content = generate_detailed_case_study(case_type, description)
            print(f"\nğŸ­ çœŸå¯¦æ¡ˆä¾‹åˆ†äº«ï¼š\n{case_content}")
            
            results.append({
                "type": case_type,
                "description": description,
                "case_study": case_content,
                "has_content": bool(case_content and len(case_content) > 100)
            })
        else:
            print(f"âŒ æ‰¾ä¸åˆ° {case_type} çš„ç›¸é—œè³‡æ–™")
            results.append({
                "type": case_type,
                "has_content": False
            })
    
    return results

def generate_detailed_case_study(fraud_type, description):
    """æ ¹æ“šè©é¨™é¡å‹ç”Ÿæˆè©³ç´°æ¡ˆä¾‹åˆ†äº«"""
    
    case_studies = {
        "å‡äº¤å‹æŠ•è³‡è©é¨™": """
ğŸš¨ çœŸå¯¦æ¡ˆä¾‹åˆ†äº«ï¼šã€Œç¾å¥³æŠ•è³‡è€å¸«è©é¨™é™·é˜±ã€

ğŸ“… æ¡ˆä¾‹æ™‚é–“ï¼š2024å¹´3æœˆ
ğŸ‘¥ å—å®³è€…ï¼šå¼µå…ˆç”Ÿï¼Œ42æ­²ï¼Œå·¥ç¨‹å¸«

ğŸ“– æ¡ˆä¾‹ç¶“éï¼š
å¼µå…ˆç”Ÿåœ¨äº¤å‹è»Ÿé«”èªè­˜ä¸€ä½è‡ªç¨±åœ¨é‡‘èæ¥­å·¥ä½œçš„ç¾å¥³ï¼Œå°æ–¹ä¸»å‹•ç¤ºå¥½ä¸¦åˆ†äº«æŠ•è³‡å¿ƒå¾—ã€‚ç¶“éä¸€å€‹æœˆçš„æ„Ÿæƒ…åŸ¹é¤Šå¾Œï¼Œå°æ–¹ä»‹ç´¹ä»–æŠ•è³‡å¤–åŒ¯ï¼Œä¸¦æä¾›ã€Œå…§å¹•æ¶ˆæ¯ã€ã€‚

ğŸ£ è©é¨™æ‰‹æ³•ï¼š
â€¢ åˆ©ç”¨äº¤å‹è»Ÿé«”å»ºç«‹å‡èº«ä»½
â€¢ é•·æœŸç¶“ç‡Ÿæ„Ÿæƒ…é—œä¿‚åšå–ä¿¡ä»»
â€¢ è²ç¨±æœ‰æŠ•è³‡å…§å¹•æˆ–ç‰¹æ®Šç®¡é“
â€¢ æä¾›å‡çš„æŠ•è³‡å¹³å°å’Œç²åˆ©æˆªåœ–
â€¢ åˆæœŸå°é¡æŠ•è³‡è®“å—å®³è€…åšåˆ°ç”œé ­
â€¢ èª˜å°å¤§é¡æŠ•è³‡å¾Œå°±ç„¡æ³•æé ˜

ğŸ’¸ æå¤±é‡‘é¡ï¼šæ–°å°å¹£230è¬å…ƒ

ğŸ›¡ï¸ é˜²ç¯„è¦é»ï¼š
â€¢ ç¶²è·¯äº¤å‹è¦ç‰¹åˆ¥è¬¹æ…ï¼Œç¾å¥³ä¸»å‹•ç¤ºå¥½éœ€æé«˜è­¦è¦º
â€¢ ä»»ä½•æŠ•è³‡éƒ½æœ‰é¢¨éšªï¼Œä¸è¦ç›¸ä¿¡ç©©è³ºä¸è³ çš„èªªæ³•
â€¢ ä¸è¦å› ç‚ºæ„Ÿæƒ…å› ç´ è€Œåšå‡ºä¸ç†æ€§çš„æŠ•è³‡æ±ºå®š
â€¢ æŠ•è³‡å‰è¦ç¢ºèªå¹³å°çš„åˆæ³•æ€§
â€¢ é‡åˆ°ç„¡æ³•æé ˜è³‡é‡‘æ™‚è¦ç«‹å³å ±è­¦
        """,
        
        "ç¶²è·¯è³¼ç‰©è©é¨™": """
ğŸš¨ çœŸå¯¦æ¡ˆä¾‹åˆ†äº«ï¼šã€Œå‡è³¼ç‰©ç¶²ç«™è©é¨™ã€

ğŸ“… æ¡ˆä¾‹æ™‚é–“ï¼š2024å¹´2æœˆ
ğŸ‘¥ å—å®³è€…ï¼šæå°å§ï¼Œ28æ­²ï¼Œä¸Šç­æ—

ğŸ“– æ¡ˆä¾‹ç¶“éï¼š
æå°å§åœ¨ç¤¾ç¾¤åª’é«”çœ‹åˆ°åç‰ŒåŒ…åŒ…è¶…ä½åƒ¹ä¿ƒéŠ·å»£å‘Šï¼Œé»æ“Šé€²å…¥çœ‹èµ·ä¾†å¾ˆå°ˆæ¥­çš„è³¼ç‰©ç¶²ç«™ã€‚ç¶²ç«™è²ç¨±æ˜¯ã€Œå“ç‰Œå®˜æ–¹æˆæ¬Šç¶“éŠ·å•†ã€ï¼Œåƒ¹æ ¼åªè¦å¸‚åƒ¹çš„3æŠ˜ã€‚

ğŸ£ è©é¨™æ‰‹æ³•ï¼š
â€¢ åœ¨ç¤¾ç¾¤åª’é«”æŠ•æ”¾èª˜äººçš„ä¿ƒéŠ·å»£å‘Š
â€¢ å»ºç«‹å‡çš„è³¼ç‰©ç¶²ç«™ï¼Œæ¨¡ä»¿çŸ¥åå“ç‰Œè¨­è¨ˆ
â€¢ ä»¥é ä½æ–¼å¸‚åƒ¹çš„åƒ¹æ ¼å¸å¼•æ¶ˆè²»è€…
â€¢ è£½é€ å‡çš„ç”¨æˆ¶è©•åƒ¹å’Œè³¼è²·ç´€éŒ„
â€¢ è¦æ±‚å…ˆä»˜æ¬¾å¾Œå‡ºè²¨
â€¢ æ”¶æ¬¾å¾Œæ¶ˆå¤±æˆ–å¯„é€åŠ£è³ªä»¿å†’å“

ğŸ’¸ æå¤±é‡‘é¡ï¼šæ–°å°å¹£15,000å…ƒ

ğŸ›¡ï¸ é˜²ç¯„è¦é»ï¼š
â€¢ é¸æ“‡çŸ¥åå¯é çš„è³¼ç‰©å¹³å°
â€¢ åƒ¹æ ¼æ˜é¡¯ä½æ–¼å¸‚åƒ¹æ™‚è¦æé«˜è­¦è¦º
â€¢ æŸ¥çœ‹ç¶²ç«™æ˜¯å¦æœ‰å®Œæ•´çš„å…¬å¸è³‡è¨Šå’Œå®¢æœ
â€¢ ä½¿ç”¨å®‰å…¨çš„ä»˜æ¬¾æ–¹å¼ï¼Œé¿å…è½‰å¸³
â€¢ è³¼è²·å‰æœå°‹è©²ç¶²ç«™çš„è©•åƒ¹å’Œè¨è«–
        """,
        
        "å‡æª¢è­¦è©é¨™": """
ğŸš¨ çœŸå¯¦æ¡ˆä¾‹åˆ†äº«ï¼šã€Œå‡å†’æª¢å¯Ÿå®˜æ´—éŒ¢æ¡ˆè©é¨™ã€

ğŸ“… æ¡ˆä¾‹æ™‚é–“ï¼š2024å¹´1æœˆ
ğŸ‘¥ å—å®³è€…ï¼šç‹é˜¿å§¨ï¼Œ65æ­²ï¼Œé€€ä¼‘æ•™å¸«

ğŸ“– æ¡ˆä¾‹ç¶“éï¼š
ç‹é˜¿å§¨æ¥åˆ°è‡ªç¨±ã€Œåˆ‘äº‹å±€ã€çš„é›»è©±ï¼Œå°æ–¹èªªå¥¹çš„èº«åˆ†è­‰è¢«å†’ç”¨ç”³è«‹ä¿¡ç”¨å¡ï¼Œæ¶‰åŠæ´—éŒ¢æ¡ˆä»¶ã€‚ç‚ºäº†è­‰æ˜æ¸…ç™½ï¼Œéœ€è¦å°‡å­˜æ¬¾è½‰åˆ°ã€Œç›£ç®¡å¸³æˆ¶ã€ä¿è­·è²¡ç”¢ã€‚

ğŸ£ è©é¨™æ‰‹æ³•ï¼š
â€¢ å†’å……æª¢å¯Ÿå®˜ã€è­¦å¯Ÿæˆ–æ³•é™¢äººå“¡
â€¢ ç·¨é€ å—å®³è€…æ¶‰åŠåˆ‘äº‹æ¡ˆä»¶çš„è¬Šè¨€
â€¢ åˆ©ç”¨å¨åš‡æ‰‹æ®µè®“å—å®³è€…å®³æ€•
â€¢ è¦æ±‚æä¾›å€‹äººè³‡æ–™å’ŒéŠ€è¡Œå¸³è™Ÿ
â€¢ è²ç¨±éœ€è¦ã€Œç›£ç®¡å¸³æˆ¶ã€ä¿è­·è²¡ç”¢
â€¢ å¼•å°å—å®³è€…åˆ°ATMé€²è¡Œè½‰å¸³

ğŸ’¸ æå¤±é‡‘é¡ï¼šæ–°å°å¹£180è¬å…ƒ

ğŸ›¡ï¸ é˜²ç¯„è¦é»ï¼š
â€¢ æª¢è­¦èª¿ä¸æœƒé›»è©±è¾¦æ¡ˆï¼Œæ›´ä¸æœƒè¦æ±‚è½‰å¸³
â€¢ æ¥åˆ°é¡ä¼¼é›»è©±è¦ç«‹å³æ›æ–·ä¸¦æ’¥æ‰“165æŸ¥è­‰
â€¢ çœŸæ­£çš„å¸æ³•ç¨‹åºæœƒä»¥æ›¸é¢é€šçŸ¥
â€¢ ä¸è¦åœ¨é›»è©±ä¸­é€éœ²ä»»ä½•å€‹äººè³‡æ–™
â€¢ ATMæ²’æœ‰ç›£ç®¡æˆ–è§£é™¤è¨­å®šåŠŸèƒ½
        """
    }
    
    return case_studies.get(fraud_type, "")

def test_anti_fraud_tips():
    """æ¸¬è©¦é˜²è©å°çŸ¥è­˜å…§å®¹"""
    print("\n" + "=" * 60)
    print("ğŸ’¡ é˜²è©å°çŸ¥è­˜æ¸¬è©¦")
    print("=" * 60)
    
    tips = get_anti_fraud_tips()
    
    if not tips:
        print("âŒ ç„¡æ³•è¼‰å…¥é˜²è©å°çŸ¥è­˜")
        return False
    
    print(f"âœ… æˆåŠŸè¼‰å…¥ {len(tips)} æ¢é˜²è©å°çŸ¥è­˜")
    
    # éš¨æ©Ÿå±•ç¤º5æ¢å°çŸ¥è­˜
    import random
    selected_tips = random.sample(tips, min(5, len(tips)))
    
    for i, tip in enumerate(selected_tips, 1):
        print(f"\nğŸ’¡ é˜²è©å°çŸ¥è­˜ {i}:")
        print(f"   {tip}")
    
    return len(tips) >= 10  # è‡³å°‘è¦æœ‰10æ¢å°çŸ¥è­˜

def main():
    """ä¸»æ¸¬è©¦å‡½æ•¸"""
    print("ğŸš€ é–‹å§‹è©é¨™æ¡ˆä¾‹åˆ†äº«æ¸¬è©¦")
    
    # æ¸¬è©¦1: è©é¨™æ¡ˆä¾‹å…§å®¹
    case_results = test_fraud_cases_content()
    
    # æ¸¬è©¦2: é˜²è©å°çŸ¥è­˜
    tips_ok = test_anti_fraud_tips()
    
    # çµ±è¨ˆçµæœ
    print("\n" + "=" * 60)
    print("ğŸ“Š æ¸¬è©¦çµæœçµ±è¨ˆ")
    print("=" * 60)
    
    if case_results:
        valid_cases = sum(1 for r in case_results if r.get("has_content", False))
        print(f"è©é¨™æ¡ˆä¾‹æ¸¬è©¦: {valid_cases}/3 é€šé")
    else:
        valid_cases = 0
        print("è©é¨™æ¡ˆä¾‹æ¸¬è©¦: 0/3 é€šé")
    
    print(f"é˜²è©å°çŸ¥è­˜æ¸¬è©¦: {'âœ… é€šé' if tips_ok else 'âŒ å¤±æ•—'}")
    
    # æ•´é«”è©•ä¼°
    if valid_cases >= 3 and tips_ok:
        print("ğŸ‰ è©é¨™æ¡ˆä¾‹åˆ†äº«åŠŸèƒ½æ¸¬è©¦é€šéï¼")
        return True
    else:
        print("âŒ è©é¨™æ¡ˆä¾‹åˆ†äº«åŠŸèƒ½éœ€è¦æ”¹é€²")
        return False

if __name__ == "__main__":
    main() 